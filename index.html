<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TAR.10.1.3. - Ticaret Yolu HaritasÄ±</title>
  <meta name="author" content="Cresas-Emre">

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f8f8f8;
    }

    #map {
      height: 100vh;
      width: 100%;
    }

    .city-label {
      color: red;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      min-width: 80px;
	  font-size : 15px;
    }

    .city-label:hover {
      font-size: 15px;
      transform: scale(1.1);
    }

    .city-image {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      margin: 2px auto;
      background-size: cover;
      background-position: center;
      border: 2px solid #B8860B;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    .leaflet-popup-content {
      font-size: 16px;
      line-height: 1.5;
      max-width: 320px;
      text-align: left;
      background: #fefefe;
    }

    .leaflet-popup-content strong {
      color: #8B4513;
      font-size: 18px;
      display: block;
      margin-bottom: 8px;
      border-bottom: 2px solid #B8860B;
      padding-bottom: 5px;
    }

    .leaflet-popup-content img {
      width: 100%;
      max-width: 300px;
      height: auto;
      border-radius: 8px;
      margin: 10px 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    .trade-route-legend {
      position: absolute;
      bottom: 20px;
      left: 20px;
      background: rgba(255,255,255,0.95);
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.3);
      z-index: 1000;
      font-size: 14px;
      border: 2px solid #B8860B;
    }

    .legend-title {
      font-weight: bold;
      color: #8B4513;
      margin-bottom: 10px;
      text-align: center;
      font-size: 16px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      margin: 5px 0;
    }

    .legend-line {
      width: 30px;
      height: 3px;
      margin-right: 10px;
      border-radius: 2px;
    }
	
	   .bottom-bar {
      width: 100%;
      height: 1.2rem;
      background-color: #ffffff;
      position: absolute;
      bottom: 0;
      left: 0;
      z-index: 9999;
    }

    .silk-road { background: #DC143C; }
    .local-trade { background: #FF8C00; }
    .sea-route { background: #4169E1; }
    .alanya-tebriz-route { background: #228B22; }
    .curved-route { background: #32CD32; }

    /* Mobil responsive */
    @media (max-width: 768px) {
      .trade-route-legend {
        top: 10px;
        right: 10px;
        left: 10px;
        right: 10px;
        font-size: 12px;
        padding: 10px;
      }
      
      .legend-title {
        font-size: 14px;
      }
      
      .city-label {
        font-size: 14px;
        padding: 3px 6px;
        min-width: 70px;
      }
      
      .city-image {
        width: 30px;
        height: 30px;
      }
      
      .leaflet-popup-content {
        font-size: 14px;
        max-width: 280px;
      }
      
      .leaflet-popup-content strong {
        font-size: 16px;
      }
	  
	     .bottom-bar {
      width: 100%;
      height: 2rem;
      background-color: #ffffff;
      position: absolute;
      bottom: 0;
      left: 0;
      z-index: 9999;
    }
	
	    .trade-route-legend {
      display : none;
    }
    }
  </style>
</head>
<body>
  <div id="map"></div>
  
  <div class="trade-route-legend">
    <div class="legend-title">ğŸ›¤ï¸ Ticaret YollarÄ±</div>
	<!--
    <div class="legend-item">
      <div class="legend-line silk-road"></div>
      <span>Ä°pek Yolu Ana Hat</span>
    </div>
    <div class="legend-item">
      <div class="legend-line local-trade"></div>
      <span>BÃ¶lgesel Ticaret</span>
    </div>
    <div class="legend-item">
      <div class="legend-line sea-route"></div>
      <span>Deniz Ticareti</span>
    </div>
	-->
    <div class="legend-item">
      <div class="legend-line curved-route"></div>
      <span>Kervan Yolu</span>
    </div>
  </div>
  
    <div class="bottom-bar"></div>


  <script>
    // Responsive minZoom ayarlarÄ±
    var isMobile = window.innerWidth < 768;
    var responsiveMinZoom = isMobile ? 5.3 : 5.8;
    var responsiveZoom = isMobile ? 5 : 6;
    var responsiveSetViewZoom = isMobile ? 5 : 6;
    
    // Responsive maxBounds ayarlarÄ± - Mobilde daha geniÅŸ alan
    var responsiveMaxBounds = isMobile ? [
      [28, 22],  // Sol-alt kÃ¶ÅŸe (daha batÄ±ya geniÅŸletildi)
      [56, 52]   // SaÄŸ-Ã¼st kÃ¶ÅŸe (daha doÄŸuya geniÅŸletildi)
    ] : [
      [28, 25],  // MasaÃ¼stÃ¼ iÃ§in orijinal
      [56, 48]
    ];

    // Beyaz, minimal harita katmanÄ±
    var map = L.map('map', {
      minZoom: responsiveMinZoom,
      maxZoom: 10,
      zoom: responsiveZoom,
      zoomSnap: 0.25,
      worldCopyJump: false,
     maxBounds: responsiveMaxBounds
    }).setView([38.5, 35.2], responsiveSetViewZoom);

    // Beyaz, ÅŸehir isimsiz minimal harita katmanÄ± gÃ¶nderilen ref'e uygun
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
      subdomains: 'abcd',
      maxZoom: 20
    }).addTo(map);

    // Åehirler verisi - YENÄ° GÃœZERGAH DAHÄ°L
    var cities = [
      {
        name: 'Konya',
        lat: 37.8746,
        lng: 32.4932,
        description: 'TÃ¼rkiye SelÃ§uklularÄ±nÄ±n baÅŸkenti Konya birÃ§ok Ã¼lke tÃ¼ccarlarÄ±nÄ±n en Ã¶nemli uÄŸrak merkeziydi. Alanya-Tebriz kÄ±vrÄ±mlÄ± yolunun Ã¶nemli bir duraÄŸÄ±dÄ±r.',
        image: 'konya-zazadin.jpg'
      },
      {
        name: 'Sinop',
        lat: 42.0231,
        lng: 35.1531,
        description: 'Buradan Ã§Ä±karÄ±lan bakÄ±r ve elde edilen keresteler birÃ§ok Ã¼lkeye ihraÃ§ edilirdi. AyrÄ±ca ÅŸehirde yetiÅŸen atlar gerek tÃ¼ccarlarÄ±n gerekse bÃ¶lge halkÄ±nÄ±n ilgisi Ã§ekmekteydi.',
        image: 'Sinop.jpg'
      },
      {
        name: 'Antalya',
        lat: 36.8841,
        lng: 30.7056,
        description: 'BÃ¶lgede Ã§Ä±karÄ±lan keresteler iÅŸlenerek deniz yolu ile birÃ§ok Ã¼lkeye ihraÃ§ edilirdi. Alanya yolunun kÄ±vrÄ±m noktasÄ±dÄ±r.',
        image: 'Antalya.jpg'
      },
      {
        name: 'Alanya',
        lat: 36.5444,
        lng: 32.0000,
        description: 'Alanya limanÄ±ndan Ã§Ä±kan kervanlar, Ã¶nce batÄ±ya Antalya yÃ¶nÃ¼ne kÄ±vrÄ±lÄ±p sonra Konya Ã¼zerinden doÄŸuya doÄŸru Tebriz\'e uzanan kÄ±vrÄ±mlÄ± yolda ticaret yapmÄ±ÅŸlardÄ±r.',
        image: 'Antalya.jpg'
      },

      {
        name: 'AyÄ±ntap (Antep)',
        lat: 37.0662,
        lng: 37.3833,
        description: 'Ä°pek Yolu\'nun Ã¶nemli gÃ¼zergÃ¢h noktalarÄ±ndan biri olan ÅŸehir Anadolu ile Halep arasÄ±nda Ã¶nemli bir ticari merkez konumundadÄ±r.',
        image: 'Antalya-Isparta-Edvir.jpg'
      },
      {
        name: 'Musul',
        lat: 36.3350,
        lng: 43.1189,
        description: 'Irak sÄ±nÄ±rlarÄ± iÃ§erisinde yer alan bu Ã¶nemli ticaret ÅŸehrinden SelÃ§uklular kumaÅŸ ve baharat ithal etmiÅŸlerdir.',
        image: 'Aksaray-Sultanhan.jpg'
      },
      {
        name: 'KÃ¼tahya',
        lat: 39.4167,
        lng: 29.9833,
        description: 'Åehirde Ã§Ä±karÄ±lan gÃ¼mÃ¼ÅŸ madenleri iÅŸlenerek birÃ§ok Ã¼lkeye ihraÃ§ edilirdi.',
        image: 'Antalya-Isparta-Edvir.jpg'
      },
      {
        name: 'DiyarbakÄ±r',
        lat: 37.9144,
        lng: 40.2306,
        description: 'Åehirde Ã§Ä±karÄ±lan bakÄ±r madenleri birÃ§ok Ã¼lkeye ihraÃ§ edilirdi.',
        image: 'Aksaray-Sultanhan.jpg'
      },
      {
        name: 'Erzurum',
        lat: 39.9208,
        lng: 41.2675,
        description: 'Dericilik, dokumacÄ±lÄ±k, demircilik gibi sanayi kollarÄ±na ait Ã¼rÃ¼nler birÃ§ok Ã¼lkeye ihraÃ§ edilirdi. Alanya-Tebriz hattÄ±nÄ±n son Anadolu duraÄŸÄ±dÄ±r.',
        image: 'Antalya-Isparta-Edvir.jpg'
      },
      {
        name: 'Sivas',
        lat: 39.7477,
        lng: 37.0179,
        description: 'Demir ve demir sanayine baÄŸlÄ± iÅŸlenen birÃ§ok Ã¼rÃ¼n farklÄ± Ã¼lkelere ihraÃ§ edilirdi.',
        image: 'Aksaray-Sultanhan.jpg'
      },
      {
        name: 'Ankara',
        lat: 39.9334,
        lng: 32.8597,
        description: 'Åehrin en Ã¶nemli Ã¼rÃ¼nlerinden olan sof kumaÅŸlarÄ± birÃ§ok Ã¼lkeye ihraÃ§ edilirdi.',
        image: 'konya-zazadin.jpg'
      },
      {
        name: 'Tebriz',
        lat: 38.0800,
        lng: 46.2919,
        description: 'Ä°ran\'Ä±n kuzeybatÄ±sÄ±nda yer alan Tebriz, Ä°pek Yolu\'nun Ã¶nemli duraklarÄ±ndan biriydi. Alanya\'dan baÅŸlayan kÄ±vrÄ±mlÄ± ticaret yolunun hedef noktasÄ±dÄ±r.',
        image: 'Aksaray-Sultanhan.jpg'
      }
    ];
    
    // Åehir markerlarÄ± ekliyorum
    cities.forEach(function(city) {
      var cityIcon = L.divIcon({
        className: 'city-label',
        html: '<div class="city-image" style="background-image: url(\'' + city.image + '\')" style></div>' +
              '<div>' + city.name + '</div>',
        iconSize: [90, 70],
        iconAnchor: [45, 35]
      });

      var marker = L.marker([city.lat, city.lng], {icon: cityIcon}).addTo(map);
      
      var popupContent = '<strong>' + city.name + '</strong><br>' + 
                        '<img src="' + city.image + '" alt="' + city.name + '" onerror="this.style.display=\'none\'">' +
                        '<p>' + city.description + '</p>';
                        
      marker.bindPopup(popupContent, {
        maxWidth: 320,
        className: 'custom-popup'
      });
    });

    // Mevcut ticaret yollarÄ± kaldÄ±rÄ±ldÄ±
    // (Sivas-Antep, Konya-Antep, Erzurum-Musul Ã§izgileri kaldÄ±rÄ±ldÄ±)

    // KIVIRIMLI ALANYA-TEBRÄ°Z TÄ°CARET YOLU
    // GÃ¼zergah: Alanya â†’ (sola kÄ±vrÄ±larak Antalya'ya doÄŸru) â†’ Konya â†’ Kayseri â†’ Erzincan â†’ Erzurum â†’ Tebriz
    
    function createAdvancedCurvedRoute(waypoints, segments) {
      var allPoints = [];
      
      for (var seg = 0; seg < segments.length; seg++) {
        var segment = segments[seg];
        var start = waypoints[segment.start];
        var end = waypoints[segment.end];
        var curve = segment.curve || 0;
        var numPoints = segment.points || 20;
        
        for (var i = 0; i <= numPoints; i++) {
          var t = i / numPoints;
          
          // Temel interpolasyon
          var lat = start[0] + (end[0] - start[0]) * t;
          var lng = start[1] + (end[1] - start[1]) * t;
          
          // EÄŸri ekleme
          if (curve !== 0) {
            var perpendicular = Math.sin(t * Math.PI) * curve;
            // Dikey offset hesaplama
            var dx = end[1] - start[1];
            var dy = end[0] - start[0];
            var length = Math.sqrt(dx * dx + dy * dy);
            if (length > 0) {
              lat += (-dx / length) * perpendicular;
              lng += (dy / length) * perpendicular;
            }
          }
          
          allPoints.push([lat, lng]);
        }
      }
      
      return allPoints;
    }

    // Waypoint'ler (yeni gÃ¼zergah)
    var waypoints = [
      [36.5444, 32.0000], // 0: Alanya
      [36.8841, 30.7056], // 1: Antalya
      [37.7200, 31.2400], // 2: Isparta-BeydiÅŸehir arasÄ± (yÃ¶n iÃ§in)
      [37.8746, 31.4932], // 3: Konya
      [38.3687, 34.0370], // 4: Aksaray (yÃ¶n iÃ§in)
      [38.7312, 35.4787], // 5: Kayseri (sadece geÃ§iÅŸ)
      [39.7477, 37.0179], // 6: Sivas
      [39.7500, 39.5000], // 7: Erzincan (sadece geÃ§iÅŸ)
      [39.9208, 41.2675], // 8: Erzurum
      [38.0800, 46.2919]  // 9: Tebriz
    ];

    // Segment tanÄ±mlarÄ± (yeni eÄŸrili yol iÃ§in)
    var curvedSegments = [
      {start: 0, end: 1, curve: 0.2, points: 20}, // Alanya â†’ Antalya
      {start: 1, end: 2, curve: -0.1, points: 25},  // Antalya â†’ Isparta-BeydiÅŸehir yÃ¶nÃ¼
      {start: 2, end: 3, curve: -0.4, points: 0},  // Isparta-BeydiÅŸehir â†’ Konya (saÄŸa dÃ¶nÃ¼ÅŸ)
      {start: 3, end: 4, curve: 0.1, points: 15},  // Konya â†’ Aksaray
      {start: 4, end: 5, curve: -0.1, points: 15},  // Aksaray â†’ Kayseri
      {start: 5, end: 6, curve: 0.4, points: 15},  // Kayseri â†’ Sivas
      {start: 6, end: 7, curve: -0.2, points: 15},  // Sivas â†’ Erzincan
      {start: 7, end: 8, curve: 0.1, points: 15},  // Erzincan â†’ Erzurum
      {start: 8, end: 9, curve: -0.5, points: 25}  // Erzurum â†’ Tebriz
    ];

    // KÄ±vrÄ±mlÄ± yol noktalarÄ±nÄ± oluÅŸtur
    var curvedRoutePoints = createAdvancedCurvedRoute(waypoints, curvedSegments);
    
    // KÄ±vrÄ±mlÄ± yolu Ã§iz
    var curvedRoute = L.polyline(curvedRoutePoints, {
      color: '#32CD32',
      weight: 5,
      opacity: 0.9,
      dashArray: '15, 10',
      className: 'alanya-tebriz-curved-route'
    }).addTo(map);

    // Yola tÄ±klanabilirlik ekle
    curvedRoute.bindPopup('<strong> Kervan Yolu</strong><br>XIII-XIV. yÃ¼zyÄ±llarda Antalya LimanÄ±ndan yola Ã§Ä±kan kervanlar, (kervansaraylarÄ±n konumuna gÃ¶re bu gÃ¼zergah belirlenmiÅŸtir)BeyÅŸehir, Konya ve Kayseri Ã¼zerinden Sivas\'a, oradan da Erzincan-Erzurum yoluyla Tebriz\'e ulaÅŸmÄ±ÅŸtÄ±r. ');

    // Ana ÅŸehirleri vurgulamak iÃ§in renkli daireler ekle (Kayseri ve Erzincan hariÃ§)
    var mainRouteCities = [
      {pos: waypoints[0], name: 'Alanya', color: '#FF6B6B'},       // Alanya
      {pos: waypoints[1], name: 'Antalya', color: '#FF8E53'},      // Antalya
      {pos: waypoints[3], name: 'Konya', color: '#4ECDC4'},        // Konya
      {pos: waypoints[6], name: 'Sivas', color: '#45B7D1'},        // Sivas
      {pos: waypoints[8], name: 'Erzurum', color: '#96CEB4'},      // Erzurum
      {pos: waypoints[9], name: 'Tebriz', color: '#FFEAA7'}        // Tebriz
    ];

    mainRouteCities.forEach(function(city) {
      L.circle(city.pos, {
        color: city.color,
        fillColor: city.color,
        fillOpacity: 0.4,
        radius: 12000
      });//.addTo(map).bindTooltip(city.name + ' (KÄ±vrÄ±mlÄ± Hat)', {permanent: false, direction: 'top'});
    });

    // Harita kontrolleri Ã¶zelleÅŸtirme
    map.attributionControl.setPrefix(' Tebriz\'e uzanan kervan yolu - Dijital Ã‡izim');
    
    // Pencere boyutu deÄŸiÅŸtiÄŸinde haritayÄ± yeniden ayarla
    window.addEventListener('resize', function() {
      var newIsMobile = window.innerWidth < 768;
      var newMinZoom = newIsMobile ? 5.3 : 5.8;
      var newMaxBounds = newIsMobile ? [
        [28, 22],  // Mobil iÃ§in geniÅŸletilmiÅŸ sÄ±nÄ±rlar
        [56, 52]
      ] : [
        [28, 25],  // MasaÃ¼stÃ¼ iÃ§in orijinal sÄ±nÄ±rlar
        [56, 48]
      ];
      
      if (isMobile !== newIsMobile) {
        map.setMinZoom(newMinZoom);
        map.setMaxBounds(newMaxBounds);
        isMobile = newIsMobile;
        console.log('ğŸ”„ Ekran boyutu deÄŸiÅŸti, minZoom ve maxBounds gÃ¼ncellendi:', newMinZoom);
      }
    });
  </script>
</body>
</html>
